<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Philipp Heinrich">
<meta name="dcterms.date" content="2024-07-24">

<title>cwb-cads functionality</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="cwb-cads-functionality_files/libs/clipboard/clipboard.min.js"></script>
<script src="cwb-cads-functionality_files/libs/quarto-html/quarto.js"></script>
<script src="cwb-cads-functionality_files/libs/quarto-html/popper.min.js"></script>
<script src="cwb-cads-functionality_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="cwb-cads-functionality_files/libs/quarto-html/anchor.min.js"></script>
<link href="cwb-cads-functionality_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="cwb-cads-functionality_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="cwb-cads-functionality_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="cwb-cads-functionality_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="cwb-cads-functionality_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="cwb-cads-functionality_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="cwb-cads-functionality_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">1</span> Setup</a></li>
  <li><a href="#corpora" id="toc-corpora" class="nav-link" data-scroll-target="#corpora"><span class="header-section-number">2</span> Corpora</a>
  <ul class="collapse">
  <li><a href="#meta-data" id="toc-meta-data" class="nav-link" data-scroll-target="#meta-data"><span class="header-section-number">2.1</span> Meta Data</a></li>
  <li><a href="#subcorpora" id="toc-subcorpora" class="nav-link" data-scroll-target="#subcorpora"><span class="header-section-number">2.2</span> Subcorpora</a></li>
  </ul></li>
  <li><a href="#keyword-analysis" id="toc-keyword-analysis" class="nav-link" data-scroll-target="#keyword-analysis"><span class="header-section-number">3</span> Keyword Analysis</a>
  <ul class="collapse">
  <li><a href="#example-sz-2018-2022-vs.-faz-2020-2022" id="toc-example-sz-2018-2022-vs.-faz-2020-2022" class="nav-link" data-scroll-target="#example-sz-2018-2022-vs.-faz-2020-2022"><span class="header-section-number">3.1</span> Example: SZ-2018-2022 vs.&nbsp;FAZ-2020-2022</a>
  <ul class="collapse">
  <li><a href="#creation" id="toc-creation" class="nav-link" data-scroll-target="#creation"><span class="header-section-number">3.1.1</span> Creation</a></li>
  <li><a href="#keyword-table" id="toc-keyword-table" class="nav-link" data-scroll-target="#keyword-table"><span class="header-section-number">3.1.2</span> Keyword Table</a></li>
  </ul></li>
  <li><a href="#example-sz-2020-vs.-sz-2019" id="toc-example-sz-2020-vs.-sz-2019" class="nav-link" data-scroll-target="#example-sz-2020-vs.-sz-2019"><span class="header-section-number">3.2</span> Example: SZ-2020 vs.&nbsp;SZ-2019</a>
  <ul class="collapse">
  <li><a href="#creation-1" id="toc-creation-1" class="nav-link" data-scroll-target="#creation-1"><span class="header-section-number">3.2.1</span> Creation</a></li>
  <li><a href="#keyword-table-1" id="toc-keyword-table-1" class="nav-link" data-scroll-target="#keyword-table-1"><span class="header-section-number">3.2.2</span> Keyword Table</a></li>
  </ul></li>
  <li><a href="#example-sz-2020-vs.-remainder-of-sz-2018-2022" id="toc-example-sz-2020-vs.-remainder-of-sz-2018-2022" class="nav-link" data-scroll-target="#example-sz-2020-vs.-remainder-of-sz-2018-2022"><span class="header-section-number">3.3</span> Example: SZ-2020 vs.&nbsp;remainder of SZ-2018-2022</a>
  <ul class="collapse">
  <li><a href="#creation-2" id="toc-creation-2" class="nav-link" data-scroll-target="#creation-2"><span class="header-section-number">3.3.1</span> Creation</a></li>
  <li><a href="#keyword-table-2" id="toc-keyword-table-2" class="nav-link" data-scroll-target="#keyword-table-2"><span class="header-section-number">3.3.2</span> Keyword Table</a></li>
  <li><a href="#concordance-lines" id="toc-concordance-lines" class="nav-link" data-scroll-target="#concordance-lines"><span class="header-section-number">3.3.3</span> Concordance Lines</a></li>
  <li><a href="#visualisation-semantic-map" id="toc-visualisation-semantic-map" class="nav-link" data-scroll-target="#visualisation-semantic-map"><span class="header-section-number">3.3.4</span> Visualisation (Semantic Map)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#query" id="toc-query" class="nav-link" data-scroll-target="#query"><span class="header-section-number">4</span> Query</a>
  <ul class="collapse">
  <li><a href="#creation-3" id="toc-creation-3" class="nav-link" data-scroll-target="#creation-3"><span class="header-section-number">4.1</span> Creation</a></li>
  <li><a href="#concordancing" id="toc-concordancing" class="nav-link" data-scroll-target="#concordancing"><span class="header-section-number">4.2</span> Concordancing</a>
  <ul class="collapse">
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="header-section-number">4.2.1</span> Filtering</a></li>
  <li><a href="#sorting" id="toc-sorting" class="nav-link" data-scroll-target="#sorting"><span class="header-section-number">4.2.2</span> Sorting</a></li>
  </ul></li>
  <li><a href="#breakdown" id="toc-breakdown" class="nav-link" data-scroll-target="#breakdown"><span class="header-section-number">4.3</span> Breakdown</a></li>
  <li><a href="#meta-distribution" id="toc-meta-distribution" class="nav-link" data-scroll-target="#meta-distribution"><span class="header-section-number">4.4</span> Meta Distribution</a></li>
  <li><a href="#collocation" id="toc-collocation" class="nav-link" data-scroll-target="#collocation"><span class="header-section-number">4.5</span> Collocation</a>
  <ul class="collapse">
  <li><a href="#creation-4" id="toc-creation-4" class="nav-link" data-scroll-target="#creation-4"><span class="header-section-number">4.5.1</span> Creation</a></li>
  <li><a href="#collocation-table" id="toc-collocation-table" class="nav-link" data-scroll-target="#collocation-table"><span class="header-section-number">4.5.2</span> Collocation Table</a></li>
  <li><a href="#semantic-map" id="toc-semantic-map" class="nav-link" data-scroll-target="#semantic-map"><span class="header-section-number">4.5.3</span> Semantic Map</a></li>
  <li><a href="#concordancing-1" id="toc-concordancing-1" class="nav-link" data-scroll-target="#concordancing-1"><span class="header-section-number">4.5.4</span> Concordancing</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">cwb-cads functionality</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Philipp Heinrich </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 24, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>url_api <span class="ot">&lt;-</span> <span class="st">"http://127.0.0.1:5000"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>get API access token via <code>/user/login</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>access.token <span class="ot">&lt;-</span> <span class="fu">str_interp</span>(<span class="st">"${url_api}/user/login"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_method</span>(<span class="st">"POST"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_form</span>(<span class="at">password =</span> <span class="st">'mmda-admin'</span>, <span class="at">username =</span> <span class="st">'admin'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"access_token"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="corpora" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Corpora</h1>
<ul>
<li>corpus access via <code>/corpus/</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>corpora <span class="ot">&lt;-</span> <span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>corpora</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["cwb_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["description"],"name":[2],"type":["chr"],"align":["left"]},{"label":["id"],"name":[3],"type":["int"],"align":["right"]},{"label":["language"],"name":[4],"type":["chr"],"align":["left"]},{"label":["name"],"name":[5],"type":["chr"],"align":["left"]},{"label":["p_atts"],"name":[6],"type":["list"],"align":["right"]},{"label":["register"],"name":[7],"type":["chr"],"align":["left"]},{"label":["s_annotations"],"name":[8],"type":["list"],"align":["right"]},{"label":["s_atts"],"name":[9],"type":["list"],"align":["right"]}],"data":[{"1":"SCHWURPUS_V2","2":"Telegram Schwurbler","3":"1","4":"de","5":"Schwurpus (v2)","6":"<chr [3]>","7":"cmc","8":"<chr [37]>","9":"<chr [16]>"},{"1":"GERMAPARL-LP19","2":"Deutscher Bundestag (LP19: 2017 - 2021)","3":"2","4":"de","5":"GermaParl (19. Legislaturperiode)","6":"<chr [4]>","7":"standard","8":"<chr [17]>","9":"<chr [2]>"},{"1":"GERMAPARL-1949-2021","2":"Deutscher Bundestag (1949 - 2021)","3":"3","4":"de","5":"GermaParl (1949 - 2021)","6":"<chr [3]>","7":"standard","8":"<chr [17]>","9":"<chr [2]>"},{"1":"SZ-2018-2022","2":"NA","3":"4","4":"de","5":"Süddeutsche Zeitung (2018 - 2022)","6":"<chr [3]>","7":"standard","8":"<chr [14]>","9":"<chr [5]>"},{"1":"SZ-2009-2014","2":"NA","3":"5","4":"de","5":"Süddeutsche Zeitung (2009 - 2014)","6":"<chr [3]>","7":"standard","8":"<chr [14]>","9":"<chr [5]>"},{"1":"FAZ-2011-2014","2":"NA","3":"6","4":"de","5":"Frankfurter Allgemeine Zeitung (2011 - 2014)","6":"<chr [3]>","7":"standard","8":"<chr [9]>","9":"<chr [3]>"},{"1":"FAZ-2020-2022","2":"NA","3":"7","4":"de","5":"Frankfurter Allgemeine Zeitung (2020 - 2022)","6":"<chr [3]>","7":"standard","8":"<chr [12]>","9":"<chr [5]>"},{"1":"TAGESSCHAU-2010-2022","2":"NA","3":"8","4":"de","5":"Tagesschau (2010 - 2022)","6":"<chr [3]>","7":"standard","8":"<chr [6]>","9":"<chr [4]>"},{"1":"INFODEMIC-TELEGRAM-V2","2":"NA","3":"9","4":"de","5":"Infodemic: Telegram (v2)","6":"<chr [3]>","7":"cmc","8":"<chr [30]>","9":"<chr [16]>"},{"1":"INFODEMIC-TWITTER-USERS-V5","2":"NA","3":"10","4":"de","5":"Infodemic: Twitter Users (v5)","6":"<chr [3]>","7":"cmc","8":"<chr [4]>","9":"<chr [5]>"},{"1":"INFODEMIC-TWITTER-CORONA-DE-V3","2":"NA","3":"11","4":"de","5":"Infodemic: Twitter (v3)","6":"<chr [3]>","7":"cmc","8":"<chr [26]>","9":"<chr [5]>"},{"1":"TWEETS-DE-2019-2022","2":"NA","3":"12","4":"de","5":"German Tweets (2019 - 2022)","6":"<chr [3]>","7":"cmc","8":"<chr [26]>","9":"<chr [5]>"},{"1":"DAPPI2019","2":"NA","3":"13","4":"jap","5":"Tweets by Dappi (2019)","6":"<chr [8]>","7":"cmc","8":"<chr [18]>","9":"<chr [3]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>we use <code>"SZ-2018-2022"</code> as an example here</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>corpus.id <span class="ot">&lt;-</span> corpora <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cwb_id <span class="sc">==</span> <span class="st">"SZ-2018-2022"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/${corpus.id}"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="meta-data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="meta-data"><span class="header-section-number">2.1</span> Meta Data</h2>
<ul>
<li>indexed structural (and positional) attributes can be accessed directly at <code>/corpus/&lt;id&gt;/</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>corpus <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"p_atts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lemma" "word"  "pos"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>corpus <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"s_atts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "s"      "p"      "text"   "corpus" "issue" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>corpus <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"s_annotations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "corpus_name"       "issue_day"         "text_date"        
 [4] "text_datum"        "text_id"           "text_month"       
 [7] "text_nr_sentences" "text_ressort"      "text_rubrik"      
[10] "text_seite_end"    "text_seite_start"  "text_seitentitel" 
[13] "text_year"         "p_type"           </code></pre>
</div>
</div>
<ul>
<li><code>s_annotations</code> belong to <code>s_atts</code> (as long as the corpus was correctly indexed)</li>
<li>in this context, we refer to the <code>s_att</code> as <code>level</code> with corresponding <code>key</code>s (such that meta data is stored in <code>level_key</code>)</li>
<li>they are not stored in the database by default</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/${corpus.id}/meta/"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>list()</code></pre>
</div>
</div>
<ul>
<li>we can store meta data from annotated s-attributes (<code>level_key</code>) using a <code>PUT</code> request</li>
<li>we specify the <code>value_type</code> here (use <code>"unicode"</code> for categorical data)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/${corpus.id}/meta/"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_method</span>(<span class="st">'PUT'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">level =</span> <span class="st">'text'</span>, <span class="at">key =</span> <span class="st">'year'</span>, <span class="at">value_type =</span> <span class="st">'unicode'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$key
[1] "year"

$value_type
[1] "unicode"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/${corpus.id}/meta/"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> <span class="fu">tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"annotations"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
   key value_type
1 year    unicode</code></pre>
</div>
</div>
<ul>
<li>and corresponding frequency counts (only reasonable for categorical data)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/${corpus.id}/meta/frequencies"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">level =</span> <span class="st">'text'</span>, <span class="at">key =</span> <span class="st">'year'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["nr_spans"],"name":[1],"type":["int"],"align":["right"]},{"label":["nr_tokens"],"name":[2],"type":["int"],"align":["right"]},{"label":["value"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"47448","2":"27084916","3":"y2018","_rn_":"1"},{"1":"45970","2":"26915759","3":"y2019","_rn_":"2"},{"1":"39495","2":"25577102","3":"y2021","_rn_":"3"},{"1":"42395","2":"25043393","3":"y2020","_rn_":"4"},{"1":"33379","2":"23320680","3":"y2022","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>if you try to do this without storing the meta data first, you’ll get a <code>404</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/${corpus.id}/meta/frequencies"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">level =</span> <span class="st">'text'</span>, <span class="at">key =</span> <span class="st">'month'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `req_perform()`:
! HTTP 404 Not Found.</code></pre>
</div>
</div>
</section>
<section id="subcorpora" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="subcorpora"><span class="header-section-number">2.2</span> Subcorpora</h2>
<ul>
<li>we create subcorpora for each year in <code>"SZ-2018-2022"</code></li>
<li>we need <code>level</code>, <code>key</code>, the corresponding <code>values_unicode</code>, and the <code>name</code> of the subcorpus</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">2018</span><span class="sc">:</span><span class="dv">2022</span>){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  subcorpus <span class="ot">&lt;-</span> <span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/${corpus.id}/subcorpus/"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_method</span>(<span class="st">'PUT'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_body_json</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="at">level =</span> <span class="st">'text'</span>, <span class="at">key =</span> <span class="st">'year'</span>, <span class="at">values_unicode =</span> <span class="fu">list</span>(<span class="fu">paste0</span>(<span class="st">"y"</span>, <span class="fu">as.character</span>(y))), <span class="at">name =</span> <span class="fu">as.character</span>(y))) <span class="sc">|&gt;</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>subcorpora <span class="ot">&lt;-</span> <span class="fu">str_interp</span>(<span class="st">"${url_api}/corpus/${corpus.id}/subcorpus/"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>subcorpora</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["corpus"],"name":[1],"type":["df[,9]"],"align":["right"]},{"label":["description"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["id"],"name":[3],"type":["int"],"align":["right"]},{"label":["name"],"name":[4],"type":["chr"],"align":["left"]},{"label":["nqr_cqp"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"<df[,9] [5 × 9]>","2":"NA","3":"1","4":"2018","5":"df_6af8c31f4e","_rn_":"1"},{"1":"<df[,9] [5 × 9]>","2":"NA","3":"2","4":"2019","5":"df_535a145a0b","_rn_":"2"},{"1":"<df[,9] [5 × 9]>","2":"NA","3":"3","4":"2020","5":"df_5f708ab4c7","_rn_":"3"},{"1":"<df[,9] [5 × 9]>","2":"NA","3":"4","4":"2021","5":"df_aca6699f18","_rn_":"4"},{"1":"<df[,9] [5 × 9]>","2":"NA","3":"5","4":"2022","5":"df_e81c04ec36","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="keyword-analysis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Keyword Analysis</h1>
<ul>
<li>keyword analyses are comparisons between two frequency lists (“target” and “reference”)</li>
<li>a frequency list can either be compiled from a whole corpus or a subcorpus</li>
<li>two types of keyword analysis are supported:
<ul>
<li>(sub-)corpus 1 vs.&nbsp;(sub-)corpus 2</li>
<li>subcorpus vs.&nbsp;rest of the corpus</li>
</ul></li>
<li>mode is detected automatically
<ul>
<li>i.e.&nbsp;providing a subcorpus as the target and its original corpus as the reference will automatically switch to subcorpus vs.&nbsp;rest (if not suppressed)</li>
</ul></li>
</ul>
<section id="example-sz-2018-2022-vs.-faz-2020-2022" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="example-sz-2018-2022-vs.-faz-2020-2022"><span class="header-section-number">3.1</span> Example: SZ-2018-2022 vs.&nbsp;FAZ-2020-2022</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>corpus.id <span class="ot">&lt;-</span> corpora <span class="sc">|&gt;</span> <span class="fu">filter</span>(cwb_id <span class="sc">==</span> <span class="st">"SZ-2018-2022"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(id)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>corpus.id.reference <span class="ot">&lt;-</span> corpora <span class="sc">|&gt;</span> <span class="fu">filter</span>(cwb_id <span class="sc">==</span> <span class="st">"FAZ-2020-2022"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creation" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="creation"><span class="header-section-number">3.1.1</span> Creation</h3>
<ul>
<li>different positional attributes can be compared to one another (<code>p</code> and <code>p_reference</code>)
<ul>
<li>default: <code>lemma</code> (fallback if not given in corpus: <code>word</code>)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>kw.id <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/keyword/"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">corpus_id =</span> corpus.id,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">corpus_id_reference =</span> corpus.id.reference)) <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="keyword-table" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="keyword-table"><span class="header-section-number">3.1.2</span> Keyword Table</h3>
<ul>
<li>the result of a keyword analysis is a frequency comparison table of individual <code>items</code> with corresponding association measures (<code>scores</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>kw.table.page <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/keyword/${kw.id}/items"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>kw.table.page <span class="sc">|&gt;</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"scores"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> measure, <span class="at">values_from =</span> score) <span class="sc">|&gt;</span> </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> kw.table.page <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"item"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["O11"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["O12"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["O21"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["O22"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["R1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["C1"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["C2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["E11"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["E12"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["E21"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["E22"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["z_score"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["t_score"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["log_likelihood"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["simple_ll"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["min_sensitivity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["liddell"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["dice"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["log_ratio"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["conservative_log_ratio"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["mutual_information"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["local_mutual_information"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["ipm"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["ipm_reference"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["ipm_expected"],"name":[28],"type":["dbl"],"align":["right"]}],"data":[{"1":"„","2":"1144421","3":"126797429","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"1144421","9":"217365914","10":"218510335","11":"670079.701","12":"127271770","13":"474341.299","14":"90094144","15":"579.46566","16":"443.40239","17":"1229382.812","18":"276437.133","19":"0.008945","20":"0.416664","21":"0.017731","22":"29.593564","23":"15.280858","24":"0.232459","25":"266031.369","26":"8944.85268","27":"0.000000","28":"5237.37699"},{"1":"“","2":"1144140","3":"126797710","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"1144140","9":"217366195","10":"218510335","11":"669915.170","12":"127271935","13":"474224.830","14":"90094260","15":"579.39452","16":"443.34795","17":"1229079.899","18":"276369.257","19":"0.008943","20":"0.416663","21":"0.017727","22":"29.593209","23":"15.280503","24":"0.232459","25":"265966.048","26":"8942.65637","27":"0.000000","28":"5236.09101"},{"1":"–","2":"675432","3":"127266418","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"675432","9":"217834903","10":"218510335","11":"395477.951","12":"127546372","13":"279954.049","14":"90288531","15":"445.16972","16":"340.64023","17":"724542.092","18":"163151.922","19":"0.005279","20":"0.415767","21":"0.010503","22":"28.832828","23":"14.520113","24":"0.232459","25":"157010.488","26":"5279.21083","27":"0.000000","28":"3091.07576"},{"1":"…","2":"10547","3":"127931303","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"10547","9":"218499788","10":"218510335","11":"6175.464","12":"127935675","13":"4371.536","14":"90564113","15":"55.62875","16":"42.56666","17":"11291.081","18":"2547.648","19":"0.000082","20":"0.414501","21":"0.000165","22":"22.831922","23":"8.517837","24":"0.232459","25":"2451.749","26":"82.43589","27":"0.000000","28":"48.26774"},{"1":"►seite","2":"8007","3":"127933843","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"8007","9":"218502328","10":"218510335","11":"4688.247","12":"127937162","13":"3318.753","14":"90565166","15":"48.46963","16":"37.08857","17":"8571.820","18":"1934.107","19":"0.000063","20":"0.414497","21":"0.000125","22":"22.434423","23":"8.119897","24":"0.232459","25":"1861.302","26":"62.58312","27":"0.000000","28":"36.64358"},{"1":"‘","2":"7844","3":"127934006","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"7844","9":"218502491","10":"218510335","11":"4592.807","12":"127937257","13":"3251.193","14":"90565234","15":"47.97374","16":"36.70911","17":"8397.318","18":"1894.734","19":"0.000061","20":"0.414496","21":"0.000123","22":"22.404751","23":"8.090186","24":"0.232459","25":"1823.411","26":"61.30910","27":"0.000000","28":"35.89762"},{"1":"81677","2":"6897","3":"127934953","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"6897","9":"218503438","10":"218510335","11":"4038.321","12":"127937812","13":"2858.679","14":"90565626","15":"44.98471","16":"34.42193","17":"7383.495","18":"1665.984","19":"0.000054","20":"0.414495","21":"0.000108","22":"22.219131","23":"7.904309","24":"0.232459","25":"1603.272","26":"53.90730","27":"0.000000","28":"31.56372"},{"1":"SZ","2":"31102","3":"127910748","4":"56","5":"90568429","6":"127941850","7":"90568485","8":"31158","9":"218479177","10":"218510335","11":"18243.586","12":"127923606","13":"12914.414","14":"90555571","15":"95.19898","16":"72.91103","17":"32577.010","18":"7466.428","19":"0.000243","20":"0.412743","21":"0.000486","22":"8.618932","23":"7.594933","24":"0.231678","25":"7205.652","26":"243.09481","27":"0.618317","28":"142.59280"},{"1":"Erdoğan","2":"5524","3":"127936326","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"5524","9":"218504811","10":"218510335","11":"3234.404","12":"127938616","13":"2289.596","14":"90566195","15":"40.25888","16":"30.80576","17":"5913.623","18":"1334.333","19":"0.000043","20":"0.414492","21":"0.000086","22":"21.898875","23":"7.583524","24":"0.232459","25":"1284.105","26":"43.17587","27":"0.000000","28":"25.28027"},{"1":"089","2":"9974","3":"127931876","4":"8","5":"90568477","6":"127941850","7":"90568485","8":"9982","9":"218500353","10":"218510335","11":"5844.646","12":"127936005","13":"4137.354","14":"90564348","15":"54.01359","16":"41.34733","17":"10561.670","18":"2402.614","19":"0.000078","20":"0.413699","21":"0.000156","22":"9.785369","23":"7.485245","24":"0.232111","25":"2315.077","26":"77.95729","27":"0.088331","28":"45.68205"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>by default, the top <code>page_size=10</code> items according to <code>sort_by="conservative_log_ratio"</code> are given</li>
<li>user should be able to switch between different association measures and paginate through results</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>kw.table.page <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/keyword/${kw.id}/items"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">sort_by =</span> <span class="st">"log_likelihood"</span>, <span class="at">page_size =</span> <span class="dv">20</span>, <span class="at">page_number =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>kw.table.page <span class="sc">|&gt;</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"scores"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> measure, <span class="at">values_from =</span> score) <span class="sc">|&gt;</span> </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> kw.table.page <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"item"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["O11"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["O12"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["O21"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["O22"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["R1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["C1"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["C2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["E11"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["E12"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["E21"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["E22"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["z_score"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["t_score"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["log_likelihood"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["simple_ll"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["min_sensitivity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["liddell"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["dice"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["log_ratio"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["conservative_log_ratio"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["mutual_information"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["local_mutual_information"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["ipm"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["ipm_reference"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["ipm_expected"],"name":[28],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"54399","3":"127887451","4":"10263","5":"90558222","6":"127941850","7":"90568485","8":"64662","9":"218445673","10":"218510335","11":"37860.799","12":"127903989","13":"26801.201","14":"90541684","15":"84.99500","16":"70.90760","17":"19733.83","18":"6355.205","19":"0.000425","20":"0.255840","21":"0.000850","22":"1.907720","23":"1.816106","24":"0.157401","25":"8562.465","26":"425.18535","27":"113.317563","28":"295.92193"},{"1":"8","2":"36183","3":"127905667","4":"4132","5":"90564353","6":"127941850","7":"90568485","8":"40315","9":"218470020","10":"218510335","11":"23605.180","12":"127918245","13":"16709.820","14":"90551775","15":"81.86566","16":"66.12309","17":"19365.43","18":"5753.559","19":"0.000283","20":"0.312046","21":"0.000565","22":"2.631992","23":"2.492895","24":"0.185497","25":"6711.848","26":"282.80817","27":"45.622934","28":"184.49928"},{"1":"?","2":"288256","3":"127653594","4":"131459","5":"90437026","6":"127941850","7":"90568485","8":"419715","9":"218090620","10":"218510335","11":"245750.910","12":"127696099","13":"173964.090","14":"90394521","15":"85.74195","16":"79.16838","17":"18347.89","18":"6961.075","19":"0.002253","20":"0.101466","21":"0.004491","22":"0.634330","23":"0.605852","24":"0.069283","25":"19971.304","26":"2253.02354","27":"1451.487236","28":"1920.80159"},{"1":"/","2":"114996","3":"127826854","4":"39067","5":"90529418","6":"127941850","7":"90568485","8":"154063","9":"218356272","10":"218510335","11":"90206.741","12":"127851643","13":"63856.259","14":"90504629","15":"82.53612","16":"73.10081","17":"17460.44","18":"6261.973","19":"0.000899","20":"0.161017","21":"0.001795","22":"1.059154","23":"1.009111","24":"0.105444","25":"12125.608","26":"898.81458","27":"431.353136","28":"705.06047"},{"1":"mal","2":"85002","3":"127856848","4":"26729","5":"90541756","6":"127941850","7":"90568485","8":"111731","9":"218398604","10":"218510335","11":"65420.571","12":"127876429","13":"46310.429","14":"90522175","15":"76.55741","16":"67.16296","17":"15139.27","18":"5350.655","19":"0.000664","20":"0.175345","21":"0.001328","22":"1.170684","23":"1.110795","24":"0.113715","25":"9665.987","26":"664.37995","27":"295.124734","28":"511.33051"},{"1":"Tel.","2":"15725","3":"127926125","4":"197","5":"90568288","6":"127941850","7":"90568485","8":"15922","9":"218494413","10":"218510335","11":"9322.626","12":"127932527","13":"6599.374","14":"90561886","15":"66.30891","16":"51.05587","17":"15059.53","18":"3637.546","19":"0.000123","20":"0.402138","21":"0.000246","22":"5.820306","23":"5.241923","24":"0.227052","25":"3570.399","26":"122.90740","27":"2.175150","28":"72.86612"},{"1":"9","2":"28716","3":"127913134","4":"3416","5":"90565069","6":"127941850","7":"90568485","8":"32132","9":"218478203","10":"218510335","11":"18813.881","12":"127923036","13":"13318.119","14":"90555167","15":"72.19197","16":"58.43407","17":"14991.52","18":"4481.429","19":"0.000224","20":"0.308215","21":"0.000449","22":"2.573067","23":"2.419910","24":"0.183646","25":"5273.565","26":"224.44572","27":"37.717314","28":"147.05025"},{"1":"Bayern","2":"49347","3":"127892503","4":"10994","5":"90557491","6":"127941850","7":"90568485","8":"60341","9":"218449994","10":"218510335","11":"35330.774","12":"127906519","13":"25010.226","14":"90543475","15":"74.56835","16":"63.09584","17":"14906.89","18":"4943.445","19":"0.000386","20":"0.232348","21":"0.000771","22":"1.667839","23":"1.578007","24":"0.145108","25":"7160.625","26":"385.69866","27":"121.388803","28":"276.14712"},{"1":"ja","2":"89780","3":"127852070","4":"29385","5":"90539100","6":"127941850","7":"90568485","8":"119165","9":"218391170","10":"218510335","11":"69773.316","12":"127872077","13":"49391.684","14":"90519093","15":"75.74090","16":"66.77061","17":"14757.40","18":"5255.610","19":"0.000702","20":"0.167982","21":"0.001402","22":"1.112907","23":"1.055498","24":"0.109490","25":"9830.034","26":"701.72504","27":"324.450608","28":"545.35178"},{"1":"3.","2":"30898","3":"127910952","4":"4984","5":"90563501","6":"127941850","7":"90568485","8":"35882","9":"218474453","10":"218510335","11":"21009.576","12":"127920840","13":"14872.424","14":"90553613","15":"68.22106","16":"56.25510","17":"12939.60","18":"4058.680","19":"0.000242","20":"0.275627","21":"0.000483","22":"2.133730","23":"2.004190","24":"0.167513","25":"5175.819","26":"241.50034","27":"55.030180","28":"164.21191"},{"1":"man","2":"375694","3":"127566156","4":"194858","5":"90373627","6":"127941850","7":"90568485","8":"570552","9":"217939783","10":"218510335","11":"334068.768","12":"127607781","13":"236483.232","14":"90332002","15":"72.01761","16":"67.91091","17":"12815.40","18":"4983.615","19":"0.002936","20":"0.073147","21":"0.005847","22":"0.448728","23":"0.424831","24":"0.050998","25":"19159.787","26":"2936.44339","27":"2151.498946","28":"2611.09846"},{"1":"sie","2":"791546","3":"127150304","4":"455627","5":"90112858","6":"127941850","7":"90568485","8":"1247173","9":"217263162","10":"218510335","11":"730242.901","12":"127211607","13":"516930.099","14":"90051555","15":"71.73792","16":"68.90399","17":"12655.06","18":"5008.075","19":"0.006187","20":"0.049436","21":"0.012254","22":"0.298413","23":"0.282490","24":"0.035009","25":"27711.087","26":"6186.76375","27":"5030.745518","28":"5707.61561"},{"1":"süddeutsch","2":"16439","3":"127925411","4":"777","5":"90567708","6":"127941850","7":"90568485","8":"17216","9":"218493119","10":"218510335","11":"10080.287","12":"127931770","13":"7135.713","14":"90561349","15":"63.33340","16":"49.59427","17":"12634.68","18":"3362.376","19":"0.000128","20":"0.369378","21":"0.000257","22":"3.904655","23":"3.599082","24":"0.212402","25":"3491.685","26":"128.48806","27":"8.579143","28":"78.78803"},{"1":"2.","2":"31052","3":"127910798","4":"5679","5":"90562806","6":"127941850","7":"90568485","8":"36731","9":"218473604","10":"218510335","11":"21506.681","12":"127920343","13":"15224.319","14":"90553261","15":"65.08842","16":"54.16836","17":"11612.15","18":"3720.135","19":"0.000243","20":"0.259915","21":"0.000485","22":"1.952570","23":"1.829977","24":"0.159516","25":"4953.296","26":"242.70401","27":"62.703931","28":"168.09731"},{"1":"er","2":"671128","3":"127270722","4":"383000","5":"90185485","6":"127941850","7":"90568485","8":"1054128","9":"217456207","10":"218510335","11":"617211.476","12":"127324639","13":"436916.524","14":"90131568","15":"68.62856","16":"65.81414","17":"11578.87","18":"4578.429","19":"0.005246","20":"0.051396","21":"0.010405","22":"0.310836","23":"0.293498","24":"0.036371","25":"24409.842","26":"5245.57055","27":"4228.844062","28":"4824.15626"},{"1":"…","2":"10547","3":"127931303","4":"0","5":"90568485","6":"127941850","7":"90568485","8":"10547","9":"218499788","10":"218510335","11":"6175.464","12":"127935675","13":"4371.536","14":"90564113","15":"55.62875","16":"42.56666","17":"11291.08","18":"2547.648","19":"0.000082","20":"0.414501","21":"0.000165","22":"22.831922","23":"8.517837","24":"0.232459","25":"2451.749","26":"82.43589","27":"0.000000","28":"48.26774"},{"1":"Firma","2":"30690","3":"127911160","4":"5786","5":"90562699","6":"127941850","7":"90568485","8":"36476","9":"218473859","10":"218510335","11":"21357.374","12":"127920493","13":"15118.626","14":"90553366","15":"63.86015","16":"53.27279","17":"11139.59","18":"3587.441","19":"0.000240","20":"0.255899","21":"0.000480","22":"1.908723","23":"1.786959","24":"0.157449","25":"4832.111","26":"239.87460","27":"63.885357","28":"166.93032"},{"1":"089","2":"9974","3":"127931876","4":"8","5":"90568477","6":"127941850","7":"90568485","8":"9982","9":"218500353","10":"218510335","11":"5844.646","12":"127936005","13":"4137.354","14":"90564348","15":"54.01359","16":"41.34733","17":"10561.67","18":"2402.614","19":"0.000078","20":"0.413699","21":"0.000156","22":"9.785369","23":"7.485245","24":"0.232111","25":"2315.077","26":"77.95729","27":"0.088331","28":"45.68205"},{"1":";","2":"111574","3":"127830276","4":"45579","5":"90522906","6":"127941850","7":"90568485","8":"157153","9":"218353182","10":"218510335","11":"92015.993","12":"127849834","13":"65137.007","14":"90503348","15":"64.47523","16":"58.55218","17":"10465.98","18":"3890.329","19":"0.000872","20":"0.124542","21":"0.001742","22":"0.793152","23":"0.745624","24":"0.083700","25":"9338.709","26":"872.06805","27":"503.254526","28":"719.20168"},{"1":"1.","2":"45075","3":"127896775","4":"12190","5":"90556295","6":"127941850","7":"90568485","8":"57265","9":"218453070","10":"218510335","11":"33529.719","12":"127908320","13":"23735.281","14":"90544750","15":"63.05065","16":"54.37968","17":"10431.97","18":"3584.426","19":"0.000352","20":"0.201664","21":"0.000704","22":"1.388222","23":"1.301196","24":"0.128506","25":"5792.400","26":"352.30849","27":"134.594280","28":"262.06998"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="example-sz-2020-vs.-sz-2019" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="example-sz-2020-vs.-sz-2019"><span class="header-section-number">3.2</span> Example: SZ-2020 vs.&nbsp;SZ-2019</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>subcorpus.id <span class="ot">&lt;-</span> subcorpora <span class="sc">|&gt;</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"2020"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(id)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>subcorpus.id.reference <span class="ot">&lt;-</span> subcorpora <span class="sc">|&gt;</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"2019"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creation-1" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="creation-1"><span class="header-section-number">3.2.1</span> Creation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>kw.id <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/keyword/"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">corpus_id =</span> corpus.id,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">subcorpus_id =</span> subcorpus.id,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">corpus_id_reference =</span> corpus.id.reference,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">subcorpus_id_reference =</span> subcorpus.id.reference,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p =</span> <span class="st">'lemma'</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p_reference =</span> <span class="st">'lemma'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="keyword-table-1" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="keyword-table-1"><span class="header-section-number">3.2.2</span> Keyword Table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>kw.items <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/keyword/${kw.id}/items"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>kw.items <span class="sc">|&gt;</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"scores"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> measure, <span class="at">values_from =</span> score) <span class="sc">|&gt;</span> </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> kw.items <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"item"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["O11"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["O12"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["O21"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["O22"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["R1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["C1"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["C2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["E11"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["E12"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["E21"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["E22"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["z_score"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["t_score"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["log_likelihood"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["simple_ll"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["min_sensitivity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["liddell"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["dice"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["log_ratio"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["conservative_log_ratio"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["mutual_information"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["local_mutual_information"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["ipm"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["ipm_reference"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["ipm_expected"],"name":[28],"type":["dbl"],"align":["right"]}],"data":[{"1":"Corona-Krise","2":"5756","3":"25037637","4":"0","5":"26915759","6":"25043393","7":"26915759","8":"5756","9":"51953396","10":"51959152","11":"2774.2903","12":"25040619","13":"2981.7097","14":"26912777","15":"56.60951","16":"39.30112","17":"8402.694","18":"2438.5888","19":"0.000230","20":"0.518075","21":"0.000460","22":"22.560656","23":"8.319040","24":"0.316969","25":"1824.4729","26":"229.84106","27":"0.000000","28":"110.77933"},{"1":"Coronavirus","2":"4587","3":"25038806","4":"0","5":"26915759","6":"25043393","7":"26915759","8":"4587","9":"51954565","10":"51959152","11":"2210.8529","12":"25041182","13":"2376.1471","14":"26913383","15":"50.53513","16":"35.08399","17":"6696.059","18":"1943.3299","19":"0.000183","20":"0.518063","21":"0.000366","22":"22.233141","23":"7.990906","24":"0.316969","25":"1453.9363","26":"183.16208","27":"0.000000","28":"88.28089"},{"1":"Corona-Pandemie","2":"3104","3":"25040289","4":"0","5":"26915759","6":"25043393","7":"26915759","8":"3104","9":"51956048","10":"51959152","11":"1496.0731","12":"25041897","13":"1607.9269","14":"26914151","15":"41.57094","16":"28.86060","17":"4531.095","18":"1315.0416","19":"0.000124","20":"0.518049","21":"0.000248","22":"21.669719","23":"7.426029","24":"0.316969","25":"983.8714","26":"123.94487","27":"0.000000","28":"59.73924"},{"1":"Corona","2":"7134","3":"25036259","4":"13","5":"26915746","6":"25043393","7":"26915759","8":"7147","9":"51952005","10":"51959152","11":"3444.7277","12":"25039948","13":"3702.2723","14":"26912057","15":"62.85839","16":"43.67915","17":"10241.596","18":"3008.9479","19":"0.000285","20":"0.516270","21":"0.000570","22":"9.203966","23":"7.340117","24":"0.316178","25":"2255.6153","26":"284.86555","27":"0.482988","28":"137.55036"},{"1":"Pandemie","2":"7689","3":"25035704","4":"19","5":"26915740","6":"25043393","7":"26915759","8":"7708","9":"51951444","10":"51959152","11":"3715.1198","12":"25039678","13":"3992.8802","14":"26911766","15":"65.19711","16":"45.31895","17":"10983.647","18":"3237.8864","19":"0.000307","20":"0.515629","21":"0.000614","22":"8.764598","23":"7.168275","24":"0.315897","25":"2428.9323","26":"307.02709","27":"0.705906","28":"148.34730"},{"1":"Covid-19","2":"1863","3":"25041530","4":"0","5":"26915759","6":"25043393","7":"26915759","8":"1863","9":"51957289","10":"51959152","11":"897.9331","12":"25042495","13":"965.0669","14":"26914794","15":"32.20590","16":"22.35893","17":"2719.485","18":"789.2792","19":"0.000074","20":"0.518036","21":"0.000149","22":"20.933218","23":"6.686531","24":"0.316969","25":"590.5130","26":"74.39088","27":"0.000000","28":"35.85509"},{"1":"Lockdown","2":"1893","3":"25041500","4":"5","5":"26915754","6":"25043393","7":"26915759","8":"1898","9":"51957254","10":"51959152","11":"914.8025","12":"25042478","13":"983.1975","14":"26914776","15":"32.34170","16":"22.48285","17":"2700.477","18":"796.8220","19":"0.000076","20":"0.515402","21":"0.000151","22":"8.668264","23":"5.977867","24":"0.315823","25":"597.8535","26":"75.58880","27":"0.185765","28":"36.52869"},{"1":"Infektionszahl","2":"938","3":"25042455","4":"0","5":"26915759","6":"25043393","7":"26915759","8":"938","9":"51958214","10":"51959152","11":"452.0994","12":"25042941","13":"485.9006","14":"26915273","15":"22.85233","16":"15.86522","17":"1369.213","18":"397.3934","19":"0.000037","20":"0.518027","21":"0.000075","22":"19.943251","23":"5.689160","24":"0.316969","25":"297.3168","26":"37.45499","27":"0.000000","28":"18.05264"},{"1":"Maskenpflicht","2":"908","3":"25042485","4":"0","5":"26915759","6":"25043393","7":"26915759","8":"908","9":"51958244","10":"51959152","11":"437.6400","12":"25042955","13":"470.3600","14":"26915289","15":"22.48391","16":"15.60945","17":"1325.421","18":"384.6836","19":"0.000036","20":"0.518027","21":"0.000073","22":"19.896355","23":"5.641771","24":"0.316969","25":"287.8077","26":"36.25707","27":"0.000000","28":"17.47527"},{"1":"Corona-Zeit","2":"839","3":"25042554","4":"0","5":"26915759","6":"25043393","7":"26915759","8":"839","9":"51958313","10":"51959152","11":"404.3832","12":"25042989","13":"434.6168","14":"26915324","15":"21.61275","16":"15.00464","17":"1224.699","18":"355.4510","19":"0.000034","20":"0.518026","21":"0.000067","22":"19.782334","23":"5.526481","24":"0.316969","25":"265.9369","26":"33.50185","27":"0.000000","28":"16.14730"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="example-sz-2020-vs.-remainder-of-sz-2018-2022" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="example-sz-2020-vs.-remainder-of-sz-2018-2022"><span class="header-section-number">3.3</span> Example: SZ-2020 vs.&nbsp;remainder of SZ-2018-2022</h2>
<section id="creation-2" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="creation-2"><span class="header-section-number">3.3.1</span> Creation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>kw.id <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/keyword/"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">corpus_id =</span> corpus.id,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">subcorpus_id =</span> subcorpus.id,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">corpus_id_reference =</span> corpus.id,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p =</span> <span class="st">'lemma'</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p_reference =</span> <span class="st">'lemma'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="keyword-table-2" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="keyword-table-2"><span class="header-section-number">3.3.2</span> Keyword Table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>kw.items <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/keyword/${kw.id}/items"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>kw.items<span class="sc">$</span>scores <span class="sc">|&gt;</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> measure, <span class="at">values_from =</span> score) <span class="sc">|&gt;</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> kw.items<span class="sc">$</span>item)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["O11"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["O12"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["O21"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["O22"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["R1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["C1"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["C2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["E11"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["E12"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["E21"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["E22"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["z_score"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["t_score"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["log_likelihood"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["simple_ll"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["min_sensitivity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["liddell"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["dice"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["log_ratio"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["conservative_log_ratio"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["mutual_information"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["local_mutual_information"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["ipm"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["ipm_reference"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["ipm_expected"],"name":[28],"type":["dbl"],"align":["right"]}],"data":[{"1":"Corona-Bonds","2":"116","3":"25043277","4":"1","5":"102898456","6":"25043393","7":"102898457","8":"117","9":"127941733","10":"127941850","11":"22.90163","12":"25043370","13":"94.09837","14":"102898363","15":"19.45400","16":"8.643967","17":"367.3044","18":"190.1959","19":"5.0e-06","20":"0.795713","21":"9.0e-06","22":"8.895271","23":"4.269698","24":"0.704592","25":"81.73262","26":"4.631960","27":"0.009718","28":"0.914478"},{"1":"Coronavirus-Krise","2":"164","3":"25043229","4":"10","5":"102898447","6":"25043393","7":"102898457","8":"174","9":"127941676","10":"127941850","11":"34.05884","12":"25043359","13":"139.94117","14":"102898317","15":"22.26547","16":"10.146700","17":"462.7709","18":"255.6605","19":"7.0e-06","20":"0.746789","21":"1.3e-05","22":"6.074208","23":"3.869406","24":"0.682614","25":"111.94871","26":"6.548633","27":"0.097183","28":"1.359993"},{"1":"Tegnell","2":"79","3":"25043314","4":"1","5":"102898456","6":"25043393","7":"102898457","8":"80","9":"127941770","10":"127941850","11":"15.65924","12":"25043377","13":"64.34077","14":"102898393","15":"16.00656","16":"7.126393","17":"247.3770","18":"129.0236","19":"3.0e-06","20":"0.791760","21":"6.0e-06","22":"8.341076","23":"3.650846","24":"0.702857","25":"55.52567","26":"3.154525","27":"0.009718","28":"0.625284"},{"1":"allesgute","2":"63","3":"25043330","4":"0","5":"102898457","6":"25043393","7":"102898457","8":"63","9":"127941787","10":"127941850","11":"12.33165","12":"25043381","13":"50.66835","14":"102898406","15":"14.42867","16":"6.383612","17":"205.5018","18":"104.1650","19":"3.0e-06","20":"0.804260","21":"5.0e-06","22":"17.981807","23":"3.515506","24":"0.708319","25":"44.62413","26":"2.515634","27":"0.000000","28":"0.492411"},{"1":"Coronakrise","2":"460","3":"25042933","4":"88","5":"102898369","6":"25043393","7":"102898457","8":"548","9":"127941302","10":"127941850","11":"107.26576","12":"25043286","13":"440.73424","14":"102898016","15":"34.05784","16":"16.446319","17":"1055.8953","18":"633.9752","19":"1.8e-05","20":"0.643678","21":"3.7e-05","22":"4.424765","23":"3.510936","24":"0.632297","25":"290.85650","26":"18.368118","27":"0.855212","28":"4.283196"},{"1":"Bahrain-McLaren","2":"71","3":"25043322","4":"1","5":"102898456","6":"25043393","7":"102898457","8":"72","9":"127941778","10":"127941850","11":"14.09331","12":"25043379","13":"57.90669","14":"102898399","15":"15.15852","16":"6.753581","17":"221.4936","18":"115.7977","19":"3.0e-06","20":"0.790371","21":"6.0e-06","22":"8.187045","23":"3.473790","24":"0.702245","25":"49.85942","26":"2.835079","27":"0.009718","28":"0.562756"},{"1":"Corona-Krise","2":"5756","3":"25037637","4":"2046","5":"102896411","6":"25043393","7":"102898457","8":"7802","9":"127934048","10":"127941850","11":"1527.16685","12":"25041866","13":"6274.83315","14":"102892182","15":"108.21247","16":"55.739126","17":"10689.5960","18":"6816.7834","19":"2.3e-04","20":"0.542052","21":"4.6e-04","22":"3.530979","23":"3.318656","24":"0.576234","25":"3316.80461","26":"229.841060","27":"19.883680","28":"60.980828"},{"1":"Corona-Epidemie","2":"204","3":"25043189","4":"31","5":"102898426","6":"25043393","7":"102898457","8":"235","9":"127941615","10":"127941850","11":"45.99900","12":"25043347","13":"189.00100","14":"102898268","15":"23.29623","16":"11.062283","17":"495.6359","18":"291.7141","19":"8.0e-06","20":"0.672346","21":"1.6e-05","22":"4.756909","23":"3.306570","24":"0.646882","25":"131.96388","26":"8.145861","27":"0.301268","28":"1.836772"},{"1":"Kosanke","2":"64","3":"25043329","4":"1","5":"102898456","6":"25043393","7":"102898457","8":"65","9":"127941785","10":"127941850","11":"12.72313","12":"25043380","13":"52.27687","14":"102898405","15":"14.37555","16":"6.409609","17":"198.8661","18":"104.2253","19":"3.0e-06","20":"0.788875","21":"5.0e-06","22":"8.037300","23":"3.299070","24":"0.701586","25":"44.90151","26":"2.555564","27":"0.009718","28":"0.508043"},{"1":"Ausgangsbeschränkung","2":"565","3":"25042828","4":"140","5":"102898317","6":"25043393","7":"102898457","8":"705","9":"127941145","10":"127941850","11":"137.99701","12":"25043255","13":"567.00300","14":"102897890","15":"36.34930","16":"17.964151","17":"1201.2078","18":"738.8349","19":"2.3e-05","20":"0.605681","21":"4.5e-05","22":"4.051536","23":"3.297301","24":"0.612179","25":"345.88101","26":"22.560841","27":"1.360565","28":"5.510316"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="concordance-lines" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="concordance-lines"><span class="header-section-number">3.3.3</span> Concordance Lines</h3>
<ul>
<li>clicking on an item in the keyword table (or the semantic map, see below) should retrieve concordance lines featuring this item</li>
<li>we retrieve concordance lines using the assisted query endpoint (<code>/query/assisted/</code>), see below for more details</li>
<li>note that we performed the keyword analysis on the <code>p="lemma"</code> layer</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/assisted"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">p =</span> <span class="st">"lemma"</span>, <span class="at">items =</span> <span class="fu">list</span>(<span class="st">"Corona-Bonds"</span>), <span class="at">corpus_id =</span> corpus.id)) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>query.id <span class="ot">&lt;-</span> query <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>access to concordance lines via <code>/query/&lt;id&gt;/concordance</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/concordance"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"lines"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>actual concordance lines can be found in <code>tokens</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"tokens"</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
      cpos is_filter_item offset out_of_window      primary    secondary
1 61538593          FALSE      0         FALSE Corona-Bonds Corona-Bonds
2 61538594          FALSE      1         FALSE         oder         oder
3 61538595          FALSE      2         FALSE        nicht        nicht
4 61538596          FALSE      3         FALSE            ?            ?

[[2]]
       cpos is_filter_item offset out_of_window         primary      secondary
1  60625228          FALSE     -8         FALSE             Der            der
2  60625229          FALSE     -7         FALSE            Hahn           Hahn
3  60625230          FALSE     -6         FALSE               ,              ,
4  60625231          FALSE     -5         FALSE             das            der
5  60625232          FALSE     -4         FALSE            sind           sein
6  60625233          FALSE     -3         FALSE             die            der
7  60625234          FALSE     -2         FALSE      Euro-Bonds      Euro-Bond
8  60625235          FALSE     -1         FALSE            oder           oder
9  60625236          FALSE      0         FALSE    Corona-Bonds   Corona-Bonds
10 60625237          FALSE      1         FALSE               ,              ,
11 60625238          FALSE      2         FALSE             die            der
12 60625239          FALSE      3         FALSE         Spanien        Spanien
13 60625240          FALSE      4         FALSE             und            und
14 60625241          FALSE      5         FALSE         Italien        Italien
15 60625242          FALSE      6         FALSE         fordern        fordern
16 60625243          FALSE      7         FALSE               ,              ,
17 60625244          FALSE      8         FALSE             was            was
18 60625245          FALSE      9         FALSE     Deutschland    Deutschland
19 60625246          FALSE     10         FALSE               ,              ,
20 60625247          FALSE     11          TRUE             die            der
21 60625248          FALSE     12          TRUE     Niederlande    Niederlande
22 60625249          FALSE     13          TRUE               ,              ,
23 60625250          FALSE     14          TRUE      Österreich     Österreich
24 60625251          FALSE     15          TRUE             und            und
25 60625252          FALSE     16          TRUE        Finnland       Finnland
26 60625253          FALSE     17          TRUE             bei            bei
27 60625254          FALSE     18          TRUE             der            der
28 60625255          FALSE     19          TRUE  Videokonferenz Videokonferenz
29 60625256          FALSE     20          TRUE             der            der
30 60625257          FALSE     21          TRUE    europäischen     europäisch
31 60625258          FALSE     22          TRUE         Staats-          Staat
32 60625259          FALSE     23          TRUE             und            und
33 60625260          FALSE     24          TRUE Regierungschefs Regierungschef
34 60625261          FALSE     25          TRUE             zur             zu
35 60625262          FALSE     26          TRUE    Corona-Krise   Corona-Krise
36 60625263          FALSE     27          TRUE              am             an
37 60625264          FALSE     28          TRUE             26.            26.
38 60625265          FALSE     29          TRUE            März           März
39 60625266          FALSE     30          TRUE       ablehnten       ablehnen
40 60625267          FALSE     31          TRUE               .              .</code></pre>
</div>
</div>
<ul>
<li>meta data are stored in <code>structural</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"structural"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["corpus_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["issue_day"],"name":[2],"type":["chr"],"align":["left"]},{"label":["p_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["text_date"],"name":[4],"type":["chr"],"align":["left"]},{"label":["text_datum"],"name":[5],"type":["chr"],"align":["left"]},{"label":["text_id"],"name":[6],"type":["chr"],"align":["left"]},{"label":["text_month"],"name":[7],"type":["chr"],"align":["left"]},{"label":["text_nr_sentences"],"name":[8],"type":["chr"],"align":["left"]},{"label":["text_ressort"],"name":[9],"type":["chr"],"align":["left"]},{"label":["text_rubrik"],"name":[10],"type":["chr"],"align":["left"]},{"label":["text_seite_end"],"name":[11],"type":["chr"],"align":["left"]},{"label":["text_seite_start"],"name":[12],"type":["chr"],"align":["left"]},{"label":["text_seitentitel"],"name":[13],"type":["chr"],"align":["left"]},{"label":["text_year"],"name":[14],"type":["chr"],"align":["left"]}],"data":[{"1":"SZ-2018-2022","2":"20200417","3":"absatz","4":"20200417","5":"17042020","6":"A108366655","7":"m202004","8":"31","9":"politik","10":"streiflicht","11":"nan","12":"1","13":"na","14":"y2020","_rn_":"1"},{"1":"SZ-2018-2022","2":"20200402","3":"absatz","4":"20200402","5":"2042020","6":"A107931037","7":"m202004","8":"160","9":"die_seite_drei","10":"reportage","11":"nan","12":"3","13":"na","14":"y2020","_rn_":"2"},{"1":"SZ-2018-2022","2":"20200407","3":"absatz","4":"20200407","5":"7042020","6":"A107938128","7":"m202004","8":"71","9":"forum__leserbriefe","10":"leserbrief","11":"nan","12":"13","13":"na","14":"y2020","_rn_":"3"},{"1":"SZ-2018-2022","2":"20200406","3":"absatz","4":"20200406","5":"6042020","6":"A107936955","7":"m202004","8":"46","9":"meinungsseite","10":"leitartikel","11":"nan","12":"4","13":"na","14":"y2020","_rn_":"4"},{"1":"SZ-2018-2022","2":"20200403","3":"absatz","4":"20200403","5":"3042020","6":"A107933117","7":"m202004","8":"77","9":"wirtschaft","10":"na","11":"nan","12":"16","13":"na","14":"y2020","_rn_":"5"},{"1":"SZ-2018-2022","2":"20200424","3":"absatz","4":"20200424","5":"24042020","6":"A108702069","7":"m202004","8":"35","9":"meinungsseite","10":"kommentar","11":"nan","12":"5","13":"na","14":"y2020","_rn_":"6"},{"1":"SZ-2018-2022","2":"20200406","3":"absatz","4":"20200406","5":"6042020","6":"A107937003","7":"m202004","8":"67","9":"wirtschaft","10":"forum","11":"nan","12":"16","13":"na","14":"y2020","_rn_":"7"},{"1":"SZ-2018-2022","2":"20200406","3":"absatz","4":"20200406","5":"6042020","6":"A107937003","7":"m202004","8":"67","9":"wirtschaft","10":"forum","11":"nan","12":"16","13":"na","14":"y2020","_rn_":"8"},{"1":"SZ-2018-2022","2":"20200402","3":"absatz","4":"20200402","5":"2042020","6":"A107931122","7":"m202004","8":"53","9":"wirtschaft","10":"na","11":"nan","12":"19","13":"na","14":"y2020","_rn_":"9"},{"1":"SZ-2018-2022","2":"20200428","3":"absatz","4":"20200428","5":"28042020","6":"A108792068","7":"m202004","8":"50","9":"forum__leserbriefe","10":"leserbrief","11":"nan","12":"12","13":"na","14":"y2020","_rn_":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>when working on a subcorpus, the query must be defined on this subcorpus</li>
<li>here: <code>"SZ-2020"</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/assisted"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">p =</span> <span class="st">"lemma"</span>, <span class="at">items =</span> <span class="fu">list</span>(<span class="st">"Corona-Bonds"</span>), <span class="at">corpus_id =</span> corpus.id, <span class="at">subcorpus_id =</span> subcorpus.id, <span class="at">s =</span> <span class="st">"text"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>query.id <span class="ot">&lt;-</span> query <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/concordance"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"lines"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"structural"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(text_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "20200417" "20200402" "20200407" "20200406" "20200403" "20200424"
 [7] "20200406" "20200406" "20200402" "20200428"</code></pre>
</div>
</div>
<ul>
<li>see below for more details on concordancing</li>
</ul>
</section>
<section id="visualisation-semantic-map" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="visualisation-semantic-map"><span class="header-section-number">3.3.4</span> Visualisation (Semantic Map)</h3>
<ul>
<li>keyword tables (and collocation tables, see below) are visualised via semantic maps</li>
<li>association measures and (initial) coordinates are provided by the backend</li>
<li>semantic maps should display the top <code>page_size=200</code> items according to the <code>sort_by="conservative_log_ratio"</code> association measure
<ul>
<li>user should be able to set these parameters</li>
<li>we set <code>page_size=50</code> here, frontend should make the map zoomable (best case: get more items until a user-defined cut-off)</li>
</ul></li>
</ul>
<section id="coordinates" class="level4" data-number="3.3.4.1">
<h4 data-number="3.3.4.1" class="anchored" data-anchor-id="coordinates"><span class="header-section-number">3.3.4.1</span> Coordinates</h4>
<ul>
<li>coordinates are provided automatically for all items</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>kw.table.page <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/keyword/${kw.id}/items"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">sort_by =</span> <span class="st">"conservative_log_ratio"</span>, <span class="at">page_size =</span> <span class="dv">50</span>, <span class="at">page_number =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>coordinates <span class="ot">&lt;-</span> kw.table.page <span class="sc">|&gt;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"coordinates"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>coordinates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["semantic_map_id"],"name":[2],"type":["int"],"align":["right"]},{"label":["x"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["x_user"],"name":[4],"type":["lgl"],"align":["right"]},{"label":["y"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["y_user"],"name":[6],"type":["lgl"],"align":["right"]}],"data":[{"1":"169,00","2":"3","3":"21.9268036","4":"NA","5":"28.5743542","6":"NA"},{"1":"85,50","2":"3","3":"17.4268494","4":"NA","5":"31.5667953","6":"NA"},{"1":"Ausgangsbeschränkung","2":"3","3":"1.7663360","4":"NA","5":"-11.4499159","6":"NA"},{"1":"Bahrain-McLaren","2":"3","3":"-13.6046257","4":"NA","5":"8.7200813","6":"NA"},{"1":"Beherbergungsverbot","2":"3","3":"4.8422980","4":"NA","5":"-10.8637848","6":"NA"},{"1":"Binnenmarktgesetz","2":"3","3":"-13.3083324","4":"NA","5":"-2.4951384","6":"NA"},{"1":"Clearview","2":"3","3":"-21.1216793","4":"NA","5":"-7.7667537","6":"NA"},{"1":"Corona-Bonds","2":"3","3":"-17.2088928","4":"NA","5":"-17.1572609","6":"NA"},{"1":"Corona-Epidemie","2":"3","3":"-5.8953996","4":"NA","5":"10.5691433","6":"NA"},{"1":"Corona-Krise","2":"3","3":"-22.0893402","4":"NA","5":"-17.5248070","6":"NA"},{"1":"Coronakrise","2":"3","3":"-22.0970974","4":"NA","5":"-17.5277729","6":"NA"},{"1":"Coronavirus","2":"3","3":"-0.3125945","4":"NA","5":"-23.5521069","6":"NA"},{"1":"Coronavirus-Epidemie","2":"3","3":"5.2039986","4":"NA","5":"-28.8858738","6":"NA"},{"1":"Coronavirus-Krise","2":"3","3":"-0.2247603","4":"NA","5":"-24.6111927","6":"NA"},{"1":"Coronavirus-Pandemie","2":"3","3":"4.5451679","4":"NA","5":"-29.1907330","6":"NA"},{"1":"Desinfektionsmittel","2":"3","3":"3.4553525","4":"NA","5":"-11.3237181","6":"NA"},{"1":"Distancing","2":"3","3":"-15.5185175","4":"NA","5":"0.1063363","6":"NA"},{"1":"Ederle","2":"3","3":"-16.3626137","4":"NA","5":"21.3578529","6":"NA"},{"1":"Epidemie","2":"3","3":"5.5713530","4":"NA","5":"-28.6875381","6":"NA"},{"1":"FinCEN-File","2":"3","3":"-9.6850271","4":"NA","5":"-12.4128828","6":"NA"},{"1":"Gangelt","2":"3","3":"-0.6449572","4":"NA","5":"19.0380306","6":"NA"},{"1":"Ganß","2":"3","3":"-6.4929304","4":"NA","5":"21.6074734","6":"NA"},{"1":"Geburtstagsgruß","2":"3","3":"-12.9370356","4":"NA","5":"-23.0387897","6":"NA"},{"1":"Gehaltsverzicht","2":"3","3":"7.7849832","4":"NA","5":"-11.8626614","6":"NA"},{"1":"Geisterspiel","2":"3","3":"9.6490774","4":"NA","5":"1.7143544","6":"NA"},{"1":"HOME-OFFICE-REDAKTION","2":"3","3":"-19.0725155","4":"NA","5":"8.4895582","6":"NA"},{"1":"Heinsberg","2":"3","3":"-0.4626305","4":"NA","5":"19.1979923","6":"NA"},{"1":"Hubei","2":"3","3":"1.7200996","4":"NA","5":"6.4411340","6":"NA"},{"1":"Kaavan","2":"3","3":"-19.6740742","4":"NA","5":"19.0407753","6":"NA"},{"1":"Kabuga","2":"3","3":"-14.6168785","4":"NA","5":"4.9120688","6":"NA"},{"1":"Konjunkturpaket","2":"3","3":"11.1653328","4":"NA","5":"-10.5065069","6":"NA"},{"1":"Kosanke","2":"3","3":"-18.2497940","4":"NA","5":"27.5264759","6":"NA"},{"1":"Lautwein","2":"3","3":"-15.8814163","4":"NA","5":"23.6296139","6":"NA"},{"1":"Mok","2":"3","3":"-13.7769070","4":"NA","5":"-4.7052569","6":"NA"},{"1":"Mulan","2":"3","3":"-16.8992252","4":"NA","5":"-10.7987061","6":"NA"},{"1":"Mundschutz","2":"3","3":"16.5448284","4":"NA","5":"-12.6373549","6":"NA"},{"1":"NTT","2":"3","3":"-7.5024686","4":"NA","5":"-13.4344168","6":"NA"},{"1":"RODEMANN","2":"3","3":"-9.6191158","4":"NA","5":"18.3066959","6":"NA"},{"1":"Reisewarnung","2":"3","3":"11.2505989","4":"NA","5":"-15.3321524","6":"NA"},{"1":"Risikogebiet","2":"3","3":"0.9470749","4":"NA","5":"-21.5839272","6":"NA"},{"1":"Rotunno","2":"3","3":"-29.0178032","4":"NA","5":"1.0081794","6":"NA"},{"1":"Rubirola","2":"3","3":"-15.8355131","4":"NA","5":"9.5034475","6":"NA"},{"1":"Saisonabbruch","2":"3","3":"-1.2267115","4":"NA","5":"13.1133327","6":"NA"},{"1":"Soleimani","2":"3","3":"-10.6840601","4":"NA","5":"1.0802540","6":"NA"},{"1":"Soleimanis","2":"3","3":"-10.5265017","4":"NA","5":"1.0918909","6":"NA"},{"1":"Tegnell","2":"3","3":"-15.9098539","4":"NA","5":"13.5094995","6":"NA"},{"1":"Verch","2":"3","3":"-11.6693192","4":"NA","5":"25.5207176","6":"NA"},{"1":"Viruskrise","2":"3","3":"0.9739626","4":"NA","5":"-22.2031231","6":"NA"},{"1":"Wuhan","2":"3","3":"1.7294670","4":"NA","5":"6.4216886","6":"NA"},{"1":"allesgute","2":"3","3":"-15.0387993","4":"NA","5":"15.0969687","6":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>note that two types of coordinates are given:
<ul>
<li>initial coordinates as determined by the backend</li>
<li>user coordinates that take precedence if defined via dragging on the semantic map by the user</li>
</ul></li>
<li>semantic map = two-dimensional arrangement using coordinates + size = association measure</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> kw.table.page <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"scores"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> measure, <span class="at">values_from =</span> score) <span class="sc">|&gt;</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> kw.table.page <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"item"</span>))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> scores <span class="sc">|&gt;</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coordinates, <span class="at">by =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(x_user), x_user, x),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(y_user), y_user, y)) <span class="sc">|&gt;</span> </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item, conservative_log_ratio, x, y)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>map <span class="sc">|&gt;</span> </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(conservative_log_ratio <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> item)) <span class="sc">+</span> </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">size =</span> conservative_log_ratio), <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.size =</span> <span class="cn">NA</span>, <span class="at">min.segment.length =</span> <span class="cn">Inf</span>) <span class="sc">+</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cwb-cads-functionality_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>we filter out all items with <code>conservative_log_ratio &lt;= 0</code> here, which is probably reasonable
<ul>
<li>at the very least, items with <code>E11 &gt;= O11</code> should not be displayed</li>
<li>no defaults implemented!
<ul>
<li>some reasonable defaults can be proposed though</li>
<li>best case scenario: user-defined</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="interaction" class="level4" data-number="3.3.4.2">
<h4 data-number="3.3.4.2" class="anchored" data-anchor-id="interaction"><span class="header-section-number">3.3.4.2</span> Interaction</h4>
<ul>
<li><p>clicking on an item should retrieve relevant concordance lines, see above</p></li>
<li><p>dragging an item updates its user coordinates</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>semantic_map.id <span class="ot">&lt;-</span> coordinates <span class="sc">|&gt;</span> <span class="fu">pull</span>(semantic_map_id) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>coordinates <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/semantic-map/${semantic_map.id}/coordinates/"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_method</span>(<span class="st">'put'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">item =</span> <span class="st">"Corona-Bonds"</span>, <span class="at">x_user =</span> <span class="dv">35</span>, <span class="at">y_user =</span> <span class="dv">20</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> scores <span class="sc">|&gt;</span> </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coordinates, <span class="at">by =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(x_user), x_user, x),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(y_user), y_user, y)) <span class="sc">|&gt;</span> </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item, conservative_log_ratio, x, y)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>map <span class="sc">|&gt;</span> </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(conservative_log_ratio <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> item)) <span class="sc">+</span> </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">size =</span> conservative_log_ratio), <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.size =</span> <span class="cn">NA</span>, <span class="at">min.segment.length =</span> <span class="cn">Inf</span>) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cwb-cads-functionality_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>dropping two items together will create a discourseme, see separate document</li>
</ul>
</section>
</section>
</section>
</section>
<section id="query" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Query</h1>
<section id="creation-3" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="creation-3"><span class="header-section-number">4.1</span> Creation</h2>
<ul>
<li>we create a query using the full query end point here
<ul>
<li>for assisted mode, see above</li>
<li>for creating queries from discoursemes, see separate document</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="fu">str_interp</span>(<span class="st">"${url_api}/query/"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">corpus_id =</span> corpus.id, <span class="at">cqp_query =</span> <span class="st">'[lemma="Klimawandel"%cd] | [lemma="global"] [lemma="Erwärmung"]'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>query.id <span class="ot">&lt;-</span> query <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="concordancing" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="concordancing"><span class="header-section-number">4.2</span> Concordancing</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/concordance"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"lines"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="sc">|&gt;</span> <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "discourseme_ranges" "id"                 "structural"        
[4] "tokens"            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"tokens"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
       cpos is_filter_item offset out_of_window         primary       secondary
1  51170210          FALSE    -26          TRUE             Und             und
2  51170211          FALSE    -25          TRUE            dann            dann
3  51170212          FALSE    -24          TRUE            gibt           geben
4  51170213          FALSE    -23          TRUE              es              es
5  51170214          FALSE    -22          TRUE             die             der
6  51170215          FALSE    -21          TRUE          vielen          vieler
7  51170216          FALSE    -20          TRUE           Dinge            Ding
8  51170217          FALSE    -19          TRUE               ,               ,
9  51170218          FALSE    -18          TRUE             die             der
10 51170219          FALSE    -17          TRUE              in              in
11 51170220          FALSE    -16          TRUE             dem             der
12 51170221          FALSE    -15          TRUE            Buch            Buch
13 51170222          FALSE    -14          TRUE           nicht           nicht
14 51170223          FALSE    -13          TRUE       vorkommen       vorkommen
15 51170224          FALSE    -12          TRUE               :               :
16 51170225          FALSE    -11          TRUE        Computer        Computer
17 51170226          FALSE    -10         FALSE               ,               ,
18 51170227          FALSE     -9         FALSE        Internet        Internet
19 51170228          FALSE     -8         FALSE               ,               ,
20 51170229          FALSE     -7         FALSE Digitalisierung Digitalisierung
21 51170230          FALSE     -6         FALSE             und             und
22 51170231          FALSE     -5         FALSE               ,               ,
23 51170232          FALSE     -4         FALSE             vor             vor
24 51170233          FALSE     -3         FALSE           allem            alle
25 51170234          FALSE     -2         FALSE               ,               ,
26 51170235          FALSE     -1         FALSE             der             der
27 51170236          FALSE      0         FALSE     Klimawandel     Klimawandel
28 51170237          FALSE      1         FALSE               .               .</code></pre>
</div>
</div>
<section id="filtering" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="filtering"><span class="header-section-number">4.2.1</span> Filtering</h3>
<ul>
<li>we can filter concordance lines according to certain items in the context (<code>out_of_window=FALSE</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>item <span class="ot">=</span> <span class="st">"Erderwärmung"</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/concordance"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">filter_item =</span> item, <span class="at">filter_item_p_att =</span> <span class="st">'lemma'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"lines"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"tokens"</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
       cpos is_filter_item offset out_of_window      primary    secondary
1  11155951          FALSE     -9         FALSE           In           in
2  11155952          FALSE     -8         FALSE        Niger        Niger
3  11155953          FALSE     -7         FALSE          und          und
4  11155954          FALSE     -6         FALSE        damit        damit
5  11155955          FALSE     -5         FALSE       mitten       mitten
6  11155956          FALSE     -4         FALSE           in           in
7  11155957          FALSE     -3         FALSE          der          der
8  11155958          FALSE     -2         FALSE    Sahelzone    Sahelzone
9  11155959          FALSE     -1         FALSE         sind         sein
10 11155960          FALSE      0         FALSE  Klimawandel  Klimawandel
11 11155961          FALSE      1         FALSE          und          und
12 11155962           TRUE      2         FALSE Erderwärmung Erderwärmung
13 11155963          FALSE      3         FALSE           in           in
14 11155964          FALSE      4         FALSE       voller         voll
15 11155965          FALSE      5         FALSE        Härte        Härte
16 11155966          FALSE      6         FALSE           zu           zu
17 11155967          FALSE      7         FALSE       spüren       spüren
18 11155968          FALSE      8         FALSE            .            .</code></pre>
</div>
</div>
</section>
<section id="sorting" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="sorting"><span class="header-section-number">4.2.2</span> Sorting</h3>
<ul>
<li>we can sort according to certain offsets</li>
<li>note that this only works with sort_order != ‘random’</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/concordance"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">sort_by_offset =</span> <span class="dv">1</span>, <span class="at">sort_by_p_att =</span> <span class="st">'lemma'</span>, <span class="at">sort_order =</span> <span class="st">'ascending'</span>, <span class="at">page_size =</span> <span class="dv">20</span>, <span class="at">page_number =</span> <span class="dv">150</span>) <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"lines"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  concordance.lines  <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"tokens"</span>) <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(i) <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(offset <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(secondary) <span class="sc">|&gt;</span> </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>()</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "einstellen"
[1] "einstellen"
[1] "einstellen"
[1] "eintreten"
[1] "einwirken"
[1] "einziehen"
[1] "einzigartig"
[1] "endlich"
[1] "engagieren"
[1] "enorm"
[1] "entdecken"
[1] "entfalten"
[1] "entgegen"
[1] "entgegenstellen"
[1] "entgegentreten"
[1] "entgegenwirken"
[1] "entgegenwirken"
[1] "entgegenwirken"
[1] "entgegenwirken"
[1] "entgegenwirken"</code></pre>
</div>
</div>
</section>
</section>
<section id="breakdown" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="breakdown"><span class="header-section-number">4.3</span> Breakdown</h2>
<ul>
<li>breakdown of the query shows which items were found (and their absolute and relative frequency (instances per million (ipm) in the corpus))</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>breakdown <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/breakdown"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">p =</span> <span class="st">"lemma"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>breakdown<span class="sc">|&gt;</span> <span class="fu">select</span>(item, ipm, freq, nr_tokens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ipm"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["freq"],"name":[3],"type":["int"],"align":["right"]},{"label":["nr_tokens"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"KLIMAWANDEL","2":"0.1172408","3":"15","4":"127941850"},{"1":"Klimawandel","2":"55.0484458","3":"7043","4":"127941850"},{"1":"global Erwärmung","2":"1.3287286","3":"170","4":"127941850"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>note that nr_tokens (and ipm) is correctly calculated in subcorpora</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>subcorpus.query.id <span class="ot">&lt;-</span> <span class="fu">str_interp</span>(<span class="st">"${url_api}/query/"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">request</span>() <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_json</span>(<span class="fu">list</span>(<span class="at">corpus_id =</span> corpus.id, <span class="at">subcorpus_id =</span> subcorpus.id, <span class="at">cqp_query =</span> <span class="st">'[lemma="Klimawandel"%cd] | [lemma="global"] [lemma="Erwärmung"]'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"id"</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${subcorpus.query.id}/breakdown"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">p =</span> <span class="st">"lemma"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item, ipm, freq, nr_tokens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ipm"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["freq"],"name":[3],"type":["int"],"align":["right"]},{"label":["nr_tokens"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"KLIMAWANDEL","2":"0.07986138","3":"2","4":"25043393"},{"1":"Klimawandel","2":"51.67031480","3":"1294","4":"25043393"},{"1":"global Erwärmung","2":"1.15799005","3":"29","4":"25043393"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="meta-distribution" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="meta-distribution"><span class="header-section-number">4.4</span> Meta Distribution</h2>
<ul>
<li>meta data must be stored in database for this to work (see above)</li>
<li>meta distribution via annotated (<code>key</code>) s-attribute (<code>level</code>) with p-attribute breakdown (<code>p</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>query.meta <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/meta"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_url_query</span>(<span class="at">level =</span> <span class="st">"text"</span>, <span class="at">key =</span> <span class="st">"year"</span>, <span class="at">p =</span> <span class="st">"lemma"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>query.meta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["frequency"],"name":[1],"type":["int"],"align":["right"]},{"label":["ipm"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["item"],"name":[3],"type":["chr"],"align":["left"]},{"label":["nr_texts"],"name":[4],"type":["int"],"align":["right"]},{"label":["nr_tokens"],"name":[5],"type":["int"],"align":["right"]},{"label":["value"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1699","2":"66.426603","3":"Klimawandel","4":"39495","5":"25577102","6":"y2021","_rn_":"1"},{"1":"1695","2":"62.974260","3":"Klimawandel","4":"45970","5":"26915759","6":"y2019","_rn_":"2"},{"1":"1444","2":"61.919292","3":"Klimawandel","4":"33379","5":"23320680","6":"y2022","_rn_":"3"},{"1":"1294","2":"51.670315","3":"Klimawandel","4":"42395","5":"25043393","6":"y2020","_rn_":"4"},{"1":"911","2":"33.634958","3":"Klimawandel","4":"47448","5":"27084916","6":"y2018","_rn_":"5"},{"1":"43","2":"1.597577","3":"global Erwärmung","4":"45970","5":"26915759","6":"y2019","_rn_":"6"},{"1":"41","2":"1.513758","3":"global Erwärmung","4":"47448","5":"27084916","6":"y2018","_rn_":"7"},{"1":"33","2":"1.290217","3":"global Erwärmung","4":"39495","5":"25577102","6":"y2021","_rn_":"8"},{"1":"29","2":"1.157990","3":"global Erwärmung","4":"42395","5":"25043393","6":"y2020","_rn_":"9"},{"1":"24","2":"1.029130","3":"global Erwärmung","4":"33379","5":"23320680","6":"y2022","_rn_":"10"},{"1":"6","2":"0.234585","3":"KLIMAWANDEL","4":"39495","5":"25577102","6":"y2021","_rn_":"11"},{"1":"4","2":"0.171522","3":"KLIMAWANDEL","4":"33379","5":"23320680","6":"y2022","_rn_":"12"},{"1":"2","2":"0.074306","3":"KLIMAWANDEL","4":"45970","5":"26915759","6":"y2019","_rn_":"13"},{"1":"2","2":"0.079861","3":"KLIMAWANDEL","4":"42395","5":"25043393","6":"y2020","_rn_":"14"},{"1":"1","2":"0.036921","3":"KLIMAWANDEL","4":"47448","5":"27084916","6":"y2018","_rn_":"15"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>distribution across categorical meta data can be visualised using barplots</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>query.meta <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">floor_date</span>(<span class="fu">as.Date</span>(value, <span class="st">"y%Y"</span>), <span class="st">"year"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> ipm, <span class="at">fill =</span> item)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cwb-cads-functionality_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>visualisation is only reasonable for categorical data</p></li>
<li><p>other visualisations possible but not implemented</p></li>
<li><p>again, if you try to do this without storing the meta data first, you’ll get a <code>404</code></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>query.meta <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/meta"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_url_query</span>(<span class="at">level =</span> <span class="st">"text"</span>, <span class="at">key =</span> <span class="st">"month"</span>, <span class="at">p =</span> <span class="st">"lemma"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `req_perform()`:
! HTTP 404 Not Found.</code></pre>
</div>
</div>
</section>
<section id="collocation" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="collocation"><span class="header-section-number">4.5</span> Collocation</h2>
<section id="creation-4" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="creation-4"><span class="header-section-number">4.5.1</span> Creation</h3>
<ul>
<li>collocation analyses are linked to queries (words that appear in the vicinity of the query matches)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>collocation <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/collocation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">p =</span> <span class="st">"lemma"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>collocation.id <span class="ot">&lt;-</span> collocation <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="collocation-table" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="collocation-table"><span class="header-section-number">4.5.2</span> Collocation Table</h3>
<ul>
<li>cf.&nbsp;keyword table</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>coll.table.page <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/collocation/${collocation.id}/items"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>coll.table.page <span class="sc">|&gt;</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"scores"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> measure, <span class="at">values_from =</span> score) <span class="sc">|&gt;</span> </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> coll.table.page <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"item"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["O11"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["O12"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["O21"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["O22"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["R1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["C1"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["C2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["E11"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["E12"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["E21"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["E22"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["z_score"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["t_score"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["log_likelihood"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["simple_ll"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["min_sensitivity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["liddell"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["dice"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["log_ratio"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["conservative_log_ratio"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["mutual_information"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["local_mutual_information"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["ipm"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["ipm_reference"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["ipm_expected"],"name":[28],"type":["dbl"],"align":["right"]}],"data":[{"1":"menschengemacht","2":"105","3":"142740","4":"227","5":"127798778","6":"142845","7":"127799005","8":"332","9":"127941518","10":"127941850","11":"0.370673","12":"142844.6","13":"331.62933","14":"127798673","15":"171.85342","16":"10.210777","17":"1013.7232","18":"976.4846","19":"0.000735","20":"0.315149","21":"0.001467","22":"8.692915","23":"7.721971","24":"2.452199","25":"257.48087","26":"735.06248","27":"1.776227","28":"2.594929"},{"1":"Artensterben","2":"81","3":"142764","4":"313","5":"127798692","6":"142845","7":"127799005","8":"394","9":"127941456","10":"127941850","11":"0.439895","12":"142844.6","13":"393.56011","14":"127798611","15":"121.46348","16":"8.951123","17":"701.6108","18":"683.8182","19":"0.000567","20":"0.204468","21":"0.001131","22":"7.855055","23":"6.800924","24":"2.265136","25":"183.47605","26":"567.04820","27":"2.449158","28":"3.079524"},{"1":"Leugner","2":"24","3":"142821","4":"64","5":"127798941","6":"142845","7":"127799005","8":"88","9":"127941762","10":"127941850","11":"0.098251","12":"142844.9","13":"87.90175","14":"127798917","15":"76.25392","16":"4.878924","17":"223.3027","18":"216.1143","19":"0.000168","20":"0.271611","21":"0.000336","22":"8.390210","23":"6.227196","24":"2.387876","25":"57.30903","26":"168.01428","27":"0.500786","28":"0.687812"},{"1":"Dürre","2":"90","3":"142755","4":"974","5":"127798031","6":"142845","7":"127799005","8":"1064","9":"127940786","10":"127941850","11":"1.187939","12":"142843.8","13":"1062.81206","14":"127797942","15":"81.48449","16":"9.361613","17":"609.0346","18":"601.3421","19":"0.000630","20":"0.083471","21":"0.001251","22":"6.369300","23":"5.426480","24":"1.879448","25":"169.15036","26":"630.05355","27":"7.621343","28":"8.316278"},{"1":"Hitzewelle","2":"59","3":"142786","4":"542","5":"127798463","6":"142845","7":"127799005","8":"601","9":"127941249","10":"127941850","11":"0.671007","12":"142844.3","13":"600.32899","14":"127798405","15":"71.20673","16":"7.593788","17":"417.4548","18":"411.5706","19":"0.000413","20":"0.097054","21":"0.000823","22":"6.605726","23":"5.405941","24":"1.944125","25":"114.70338","26":"413.03511","27":"4.241035","28":"4.697447"},{"1":"Wetterextrem","2":"20","3":"142825","4":"98","5":"127798907","6":"142845","7":"127799005","8":"118","9":"127941732","10":"127941850","11":"0.131745","12":"142844.9","13":"117.86826","14":"127798887","15":"54.73845","16":"4.442677","17":"164.7259","18":"161.1682","19":"0.000140","20":"0.168375","21":"0.000280","22":"7.512486","23":"5.187243","24":"2.181296","25":"43.62591","26":"140.01190","27":"0.766829","28":"0.922294"},{"1":"Meeresspiegel","2":"41","3":"142804","4":"440","5":"127798565","6":"142845","7":"127799005","8":"481","9":"127941369","10":"127941850","11":"0.537029","12":"142844.5","13":"480.46297","14":"127798525","15":"55.21525","16":"6.319254","17":"278.0857","18":"274.5667","19":"0.000287","20":"0.084123","21":"0.000572","22":"6.381435","23":"4.910938","24":"1.882786","25":"77.19424","26":"287.02440","27":"3.442906","28":"3.759520"},{"1":"fortschreitend","2":"33","3":"142812","4":"374","5":"127798631","6":"142845","7":"127799005","8":"407","9":"127941443","10":"127941850","11":"0.454409","12":"142844.5","13":"406.54559","14":"127798598","15":"48.28017","16":"5.665460","17":"220.4216","18":"217.7363","19":"0.000231","20":"0.079965","21":"0.000461","22":"6.302750","23":"4.635002","24":"1.861067","25":"61.41522","26":"231.01964","27":"2.926470","28":"3.181133"},{"1":"Artenschwund","2":"14","3":"142831","4":"68","5":"127798937","6":"142845","7":"127799005","8":"82","9":"127941768","10":"127941850","11":"0.091552","12":"142844.9","13":"81.90845","14":"127798923","15":"45.96693","16":"3.717189","17":"115.5300","18":"113.0206","19":"0.000098","20":"0.169615","21":"0.000196","22":"7.525184","23":"4.611897","24":"2.184462","25":"30.58246","26":"98.00833","27":"0.532086","28":"0.640916"},{"1":"Umweltverschmutzung","2":"22","3":"142823","4":"212","5":"127798793","6":"142845","7":"127799005","8":"234","9":"127941616","10":"127941850","11":"0.261257","12":"142844.7","13":"233.73874","14":"127798771","15":"42.53048","16":"4.634716","17":"153.6783","18":"151.5874","19":"0.000154","20":"0.092901","21":"0.000308","22":"6.536780","23":"4.396950","24":"1.925354","25":"42.35780","26":"154.01309","27":"1.658855","28":"1.828956"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="semantic-map" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="semantic-map"><span class="header-section-number">4.5.3</span> Semantic Map</h3>
<ul>
<li>cf.&nbsp;semantic map in keyword analyses</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>coll.table.page <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/collocation/${collocation.id}/items"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">page_size =</span> <span class="dv">50</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> coll.table.page <span class="sc">|&gt;</span> </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"scores"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> measure, <span class="at">values_from =</span> score) <span class="sc">|&gt;</span> </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> coll.table.page <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"items"</span>) <span class="sc">|&gt;</span> magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"item"</span>))</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>coordinates <span class="ot">&lt;-</span> coll.table.page <span class="sc">|&gt;</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"coordinates"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> scores <span class="sc">|&gt;</span> </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coordinates, <span class="at">by =</span> <span class="st">"item"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(x_user), x_user, x),</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(y_user), y_user, y)) <span class="sc">|&gt;</span> </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item, conservative_log_ratio, x, y)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>map <span class="sc">|&gt;</span> </span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(conservative_log_ratio <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> item)) <span class="sc">+</span> </span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">size =</span> conservative_log_ratio), <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.size =</span> <span class="cn">NA</span>, <span class="at">min.segment.length =</span> <span class="cn">Inf</span>) <span class="sc">+</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cwb-cads-functionality_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="concordancing-1" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="concordancing-1"><span class="header-section-number">4.5.4</span> Concordancing</h3>
<ul>
<li>note that when clicking on an item here, concordance lines have to be filtered according to initial query <em>and</em> the additional filter item</li>
<li>you can use the additonal filter item as an argument at <code>/query/&lt;id&gt;/concordance</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>item <span class="ot">=</span> <span class="st">"Artensterben"</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="fu">str_interp</span>(<span class="st">"${url_api}/query/${query.id}/concordance"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">filter_item =</span> item, <span class="at">filter_item_p_att =</span> <span class="st">'lemma'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_auth_bearer_token</span>(access.token) <span class="sc">|&gt;</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"body"</span>) <span class="sc">|&gt;</span> <span class="fu">rawToChar</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"lines"</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>concordance.lines <span class="sc">|&gt;</span> </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"tokens"</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
     cpos is_filter_item offset out_of_window                       primary
1  682622          FALSE     -3         FALSE                            In
2  682623          FALSE     -2         FALSE                        Zeiten
3  682624          FALSE     -1         FALSE                           des
4  682625          FALSE      0         FALSE                  Klimawandels
5  682626          FALSE      1         FALSE                             ,
6  682627           TRUE      2         FALSE                 Artensterbens
7  682628          FALSE      3         FALSE                           und
8  682629          FALSE      4         FALSE                           der
9  682630          FALSE      5         FALSE                    absehbaren
10 682631          FALSE      6         FALSE                   Endlichkeit
11 682632          FALSE      7         FALSE                           der
12 682633          FALSE      8         FALSE                     Rohstoffe
13 682634          FALSE      9         FALSE                           ist
14 682635          FALSE     10         FALSE                      elitärer
15 682636          FALSE     11          TRUE                             ,
16 682637          FALSE     12          TRUE            umweltzerstörender
17 682638          FALSE     13          TRUE Milliardärs-Weltraumtourismus
18 682639          FALSE     14          TRUE                       pervers
19 682640          FALSE     15          TRUE                             ,
20 682641          FALSE     16          TRUE                         passt
21 682642          FALSE     17          TRUE                    allerdings
22 682643          FALSE     18          TRUE                           gut
23 682644          FALSE     19          TRUE                           ins
24 682645          FALSE     20          TRUE                zerstörerische
25 682646          FALSE     21          TRUE                     Zeitalter
26 682647          FALSE     22          TRUE                           des
27 682648          FALSE     23          TRUE                   Anthropozän
28 682649          FALSE     24          TRUE                             .
                       secondary
1                             in
2                           Zeit
3                            der
4                    Klimawandel
5                              ,
6                   Artensterben
7                            und
8                            der
9                       absehbar
10                   Endlichkeit
11                           der
12                      Rohstoff
13                          sein
14                        elitär
15                             ,
16              umweltzerstörend
17 Milliardärs-Weltraumtourismus
18                       pervers
19                             ,
20                        passen
21                    allerdings
22                           gut
23                            in
24                 zerstörerisch
25                     Zeitalter
26                           der
27                   Anthropozän
28                             .</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>